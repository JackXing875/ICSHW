# Homework：存储1

> 本此作业统一以 $K = 10^3, M=10^6, G=10^9$ 为计量单位。以后如果遇到类似的题目请提前查看/询问/确定这件事。

> 请直接用 Markdown 题目源文件填充答案，最后统一提交 PDF 格式，比如使用 Typora 导出。

## T1

以下是A型号磁盘的相关参数

| 参数                 | 值        |
| -------------------- | --------- |
| 盘片数               | 2         |
| 每个盘片的面数       | 2         |
| 柱面数（也叫磁道数） | 500000    |
| 平均每条磁道的扇区数 | 500       |
| 扇区大小             | 4096 Byte |
| 旋转速率             | 5400 RPM  |
| 平均寻道时间         | 10ms      |

**1.1**

求该磁盘的容量（GB 为单位）。

解：
容量为

$ C = \frac{4096 \times 500 \times 5 \times 10^5 \times 2 \times 2}{10^9} GB= 4096 GB$

故答案为 `4096 GB`
**1.2.1**

求该磁盘访问⼀个扇区的平均延迟（ms 为单位）。

$T_{\text{avg\_seek}} = 10ms$

$T_{\text{avg\_rotation}} = \frac12 \times \frac{1}{\text{RPM}} \times \frac{\text{60000s}}{\text{1min}} = 5.56 ms$

$T_{\text{avg\_transfer}} = 5.56ms \times \frac{1}{500} = 0.02ms$

故平均延迟为：

$L = 10ms +5.56ms + 0.02ms = 15.58ms$

**1.2.2**

求该磁盘随机读写时的每秒访问次数（IOPS）。

> 提示：思考磁盘的最小访问单位是什么，书上有提到

解：

$IOPS = \frac{1000ms}{L} = 64.18 $

**1.2.3**

求该磁盘的顺序读取带宽（MB/s 为单位）。

其中，顺序读取带宽的定义是
$$
\max\{\forall_{可以存储在磁盘A上的文件F} \frac{F的大小}{磁盘从随机时刻开始，顺序读取完F所需的期望时间}\}
$$
为了答案统一，有如下假设：

1. 不能确认为 0 的值，都认为是以平均值为期望的随机数（比如即使是顺序地访问磁道，每次寻道时间也是以平均寻道时间为期望的随机数）
2. 顺序存储的文件在相邻的扇区上是连续，当大小超过一个盘面的一个磁道可以容纳的空间时，你可以自己决定下一个开始存储的位置。显然本题你需要想一想什么存法读取时更快。

可以在答案中附上你答案对应的文件的存储方式（可以画图）

答：因为移动传动臂的开销是主要的开销，所以尽可能少地移动传动臂。于是采取如下策略：

- 将文件填满一个柱面：先将文件连续存储在同一个柱面下的所有盘面上（从盘面 0 到 盘面 3）。因为在同一个柱面内切换盘面是电子操作，速度很快。

- 切换到下一柱面：当一个柱面读完后，才进行机械寻道移动到下一个相邻柱面。

在读取完整柱面的周期内：

一个柱面的容量：

$C = 4096GB \div 500000 \times 1000 MB = 8.192 MB$

$T_{\text{avg\_rotation}} =  4 \times \frac{1}{\text{RPM}} \times \frac{\text{60000s}}{\text{1min}} = 44.48 ms$

故总时间

$T = 44.48 + 5.56 + 10 = 60.04 ms$

故带宽为：

$B = \frac{\text{Data}}{\text{Time}} = \frac{8.192 \text{ MB}}{0.06004 \text{ s}} \approx 136.4423 \text{ MB/s}$




